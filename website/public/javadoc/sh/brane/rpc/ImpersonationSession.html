<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>ImpersonationSession (Brane SDK 0.3.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: sh.brane.rpc, interface: ImpersonationSession">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">sh.brane.rpc</a></div>
<h1 title="Interface ImpersonationSession" class="title">Interface ImpersonationSession</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">ImpersonationSession</span><span class="extends-implements">
extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></span></div>
<div class="block">Represents an active impersonation session for a specific address on a test node.
 <p>
 Impersonation allows sending transactions from any address without possessing
 its private key. This is useful for testing scenarios where you need to simulate
 actions from specific addresses (e.g., whales, DAO contracts, or protocol admins).
 <p>
 <strong>Important:</strong> This feature is only available on test nodes (Anvil,
 Hardhat, Ganache) and will fail on production networks.
 <p>
 The session automatically stops impersonation when closed, either explicitly via
 <a href="#close()"><code>close()</code></a> or when used with try-with-resources.
 <p>
 <strong>Usage:</strong>
 <pre><code>
 // Impersonate a whale address for testing
 Address whale = Address.from("0x...");

 try (ImpersonationSession session = tester.impersonate(whale)) {
     // Send transaction as the whale
     TransactionRequest request = TransactionRequest.builder()
         .to(recipient)
         .value(Wei.fromEther("100"))
         .build();

     TransactionReceipt receipt = session.sendTransactionAndWait(request);
     System.out.println("Transfer confirmed in block " + receipt.blockNumber());
 }
 // Impersonation automatically stopped
 </code></pre></div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="Brane.Tester.html" title="interface in sh.brane.rpc"><code>Brane.Tester</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../core/types/Address.html" title="class in sh.brane.core.types">Address</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#address()" class="member-name-link">address</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the address being impersonated in this session.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../core/types/HexData.html" title="class in sh.brane.core.types">HexData</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#call(sh.brane.rpc.CallRequest)" class="member-name-link">call</a><wbr>(<a href="CallRequest.html" title="class in sh.brane.rpc">CallRequest</a>&nbsp;request)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Executes a read-only call from the impersonated address.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#close()" class="member-name-link">close</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Stops the impersonation session.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../core/types/Hash.html" title="class in sh.brane.core.types">Hash</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#sendTransaction(sh.brane.core.model.TransactionRequest)" class="member-name-link">sendTransaction</a><wbr>(<a href="../core/model/TransactionRequest.html" title="class in sh.brane.core.model">TransactionRequest</a>&nbsp;request)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sends a transaction from the impersonated address.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../core/model/TransactionReceipt.html" title="class in sh.brane.core.model">TransactionReceipt</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#sendTransactionAndWait(sh.brane.core.model.TransactionRequest)" class="member-name-link">sendTransactionAndWait</a><wbr>(<a href="../core/model/TransactionRequest.html" title="class in sh.brane.core.model">TransactionRequest</a>&nbsp;request)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sends a transaction from the impersonated address and waits for confirmation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../core/model/TransactionReceipt.html" title="class in sh.brane.core.model">TransactionReceipt</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#sendTransactionAndWait(sh.brane.core.model.TransactionRequest,long,long)" class="member-name-link">sendTransactionAndWait</a><wbr>(<a href="../core/model/TransactionRequest.html" title="class in sh.brane.core.model">TransactionRequest</a>&nbsp;request,
 long&nbsp;timeoutMillis,
 long&nbsp;pollIntervalMillis)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sends a transaction from the impersonated address and waits for confirmation
 with custom timeout settings.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="address()">
<h3>address</h3>
<div class="member-signature"><span class="return-type"><a href="../core/types/Address.html" title="class in sh.brane.core.types">Address</a></span>&nbsp;<span class="element-name">address</span>()</div>
<div class="block">Returns the address being impersonated in this session.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the impersonated address, never <code>null</code></dd>
<dt>Since:</dt>
<dd>0.2.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sendTransaction(sh.brane.core.model.TransactionRequest)">
<h3>sendTransaction</h3>
<div class="member-signature"><span class="return-type"><a href="../core/types/Hash.html" title="class in sh.brane.core.types">Hash</a></span>&nbsp;<span class="element-name">sendTransaction</span><wbr><span class="parameters">(<a href="../core/model/TransactionRequest.html" title="class in sh.brane.core.model">TransactionRequest</a>&nbsp;request)</span></div>
<div class="block">Sends a transaction from the impersonated address.
 <p>
 The transaction's <code>from</code> field is automatically set to the impersonated
 address. Any existing <code>from</code> value in the request is ignored.
 <p>
 This method returns immediately after the transaction is submitted to the
 mempool. Use <a href="#sendTransactionAndWait(sh.brane.core.model.TransactionRequest)"><code>sendTransactionAndWait(TransactionRequest)</code></a> if you need
 to wait for confirmation.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>request</code> - the transaction request (from address is automatically set)</dd>
<dt>Returns:</dt>
<dd>the transaction hash</dd>
<dt>Throws:</dt>
<dd><code><a href="../core/error/RpcException.html" title="class in sh.brane.core.error">RpcException</a></code> - if the RPC call fails</dd>
<dt>Since:</dt>
<dd>0.2.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sendTransactionAndWait(sh.brane.core.model.TransactionRequest)">
<h3>sendTransactionAndWait</h3>
<div class="member-signature"><span class="return-type"><a href="../core/model/TransactionReceipt.html" title="class in sh.brane.core.model">TransactionReceipt</a></span>&nbsp;<span class="element-name">sendTransactionAndWait</span><wbr><span class="parameters">(<a href="../core/model/TransactionRequest.html" title="class in sh.brane.core.model">TransactionRequest</a>&nbsp;request)</span></div>
<div class="block">Sends a transaction from the impersonated address and waits for confirmation.
 <p>
 Uses default timeout (60 seconds) and poll interval (1 second).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>request</code> - the transaction request (from address is automatically set)</dd>
<dt>Returns:</dt>
<dd>the transaction receipt once confirmed</dd>
<dt>Throws:</dt>
<dd><code><a href="../core/error/RpcException.html" title="class in sh.brane.core.error">RpcException</a></code> - if the RPC call fails or times out</dd>
<dd><code><a href="../core/error/RevertException.html" title="class in sh.brane.core.error">RevertException</a></code> - if the transaction reverts</dd>
<dt>Since:</dt>
<dd>0.2.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="sendTransactionAndWait(sh.brane.core.model.TransactionRequest,long,long)">
<h3>sendTransactionAndWait</h3>
<div class="member-signature"><span class="return-type"><a href="../core/model/TransactionReceipt.html" title="class in sh.brane.core.model">TransactionReceipt</a></span>&nbsp;<span class="element-name">sendTransactionAndWait</span><wbr><span class="parameters">(<a href="../core/model/TransactionRequest.html" title="class in sh.brane.core.model">TransactionRequest</a>&nbsp;request,
 long&nbsp;timeoutMillis,
 long&nbsp;pollIntervalMillis)</span></div>
<div class="block">Sends a transaction from the impersonated address and waits for confirmation
 with custom timeout settings.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>request</code> - the transaction request (from address is automatically set)</dd>
<dd><code>timeoutMillis</code> - maximum time to wait for confirmation, in milliseconds</dd>
<dd><code>pollIntervalMillis</code> - how often to poll for the receipt, in milliseconds</dd>
<dt>Returns:</dt>
<dd>the transaction receipt once confirmed</dd>
<dt>Throws:</dt>
<dd><code><a href="../core/error/RpcException.html" title="class in sh.brane.core.error">RpcException</a></code> - if the RPC call fails or times out</dd>
<dd><code><a href="../core/error/RevertException.html" title="class in sh.brane.core.error">RevertException</a></code> - if the transaction reverts</dd>
<dt>Since:</dt>
<dd>0.2.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="call(sh.brane.rpc.CallRequest)">
<h3>call</h3>
<div class="member-signature"><span class="return-type"><a href="../core/types/HexData.html" title="class in sh.brane.core.types">HexData</a></span>&nbsp;<span class="element-name">call</span><wbr><span class="parameters">(<a href="CallRequest.html" title="class in sh.brane.rpc">CallRequest</a>&nbsp;request)</span></div>
<div class="block">Executes a read-only call from the impersonated address.
 <p>
 The call's <code>from</code> field is automatically set to the impersonated
 address. Any existing <code>from</code> value in the request is ignored.
 <p>
 This is useful for testing view functions that behave differently based
 on msg.sender, such as balance checks or permission verifications.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>request</code> - the call request (from address is automatically set)</dd>
<dt>Returns:</dt>
<dd>the call result data</dd>
<dt>Throws:</dt>
<dd><code><a href="../core/error/RpcException.html" title="class in sh.brane.core.error">RpcException</a></code> - if the RPC call fails</dd>
<dt>Since:</dt>
<dd>0.3.0</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="close()">
<h3>close</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">close</span>()</div>
<div class="block">Stops the impersonation session.
 <p>
 After calling this method, the impersonated address can no longer be used
 to send transactions without proper signing. This method is idempotent;
 calling it multiple times has no additional effect.
 <p>
 This method does not throw exceptions. Any errors during cleanup are logged
 but not propagated.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html#close()" title="class or interface in java.lang" class="external-link">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code></dd>
<dt>Since:</dt>
<dd>0.2.0</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
