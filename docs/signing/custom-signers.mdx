---
title: Custom Signers
description: 'Integrate external signers like Privy, AWS KMS, or HSMs.'
---

Brane supports external signing via the `Signer` interface. This allows you to use keys managed by third-party services (Privy, Fireblocks, AWS KMS) or hardware wallets without exposing the private key to your application.

## The Interface

To implement a custom signer, you must implement the `Signer` interface.

```java
public interface Signer {
    Signature signTransaction(UnsignedTransaction tx, long chainId);
    Signature signMessage(byte[] message);
    Address address();
}
```

## Example: External Service Integration

Here is how you might implement a signer that delegates to an external API (e.g., Privy or a backend KMS).

```java
import io.brane.core.crypto.Signer;
import io.brane.core.crypto.Signature;
import io.brane.core.types.Address;
import io.brane.core.tx.UnsignedTransaction;
import io.brane.core.crypto.Keccak256;

// Dummy interface for the example
interface ExternalService {
    Signature sign(String keyId, byte[] hash);
}

public class RemoteSigner implements Signer {
    private final String keyId;
    private final Address address;
    private final ExternalService service;

    public RemoteSigner(String keyId, Address address, ExternalService service) {
        this.keyId = keyId;
        this.address = address;
        this.service = service;
    }

    @Override
    public Address address() {
        return address;
    }

    @Override
    public Signature signTransaction(UnsignedTransaction tx, long chainId) {
        // 1. Get the transaction hash (preimage)
        byte[] preimage = tx.encodeForSigning(chainId);
        byte[] hash = Keccak256.hash(preimage);

        // 2. Request signature from external service
        return service.sign(this.keyId, hash);
    }

    @Override
    public Signature signMessage(byte[] message) {
        // 1. Hash the message according to EIP-191
        // Note: The external service might expect the raw message or the hash.
        // Here we assume it expects the hash of the message.
        byte[] hash = Keccak256.hash(message);
        
        return service.sign(this.keyId, hash);
    }
}
```

## Usage with WalletClient

Once you have your custom signer, simply pass it to the `WalletClient` builder.

```java
import io.brane.rpc.DefaultWalletClient;
import io.brane.rpc.BraneProvider;
import io.brane.rpc.PublicClient;
import io.brane.core.chain.ChainProfiles;

// Assume these are defined
BraneProvider provider = ...;
PublicClient publicClient = ...;
ExternalService service = ...;

Signer mySigner = new RemoteSigner(
    "key-123", 
    new Address("0x..."), 
    service
);

WalletClient wallet = DefaultWalletClient.create(
    provider,
    publicClient,
    mySigner,
    ChainProfiles.ANVIL_LOCAL
);
```
